session:
  # Be sure to change this to your domain. You can also define multiple domains
  cookies:
    - domain: ${INGRESS_URL}
      authelia_url: https://auth.${INGRESS_URL}
authentication_backend:
  # lldap setup
  # https://github.com/lldap/lldap/blob/main/example_configs/authelia_config.yml
  ldap:
    implementation: lldap
    address: ldap://lldap-ldap.lldap.svc.cluster.local:3890
    base_dn: dc=${BASE_DN},dc=xyz
    user: uid=manager,ou=people,dc=${BASE_DN},dc=xyz
    # user with lldap_password_manager group
    # above user password in plain text
    password: ${LLDAP_MANAGER_PASS}
notifier:
  disable_startup_check: true
  # smtp setup (example is gmail)
  smtp:
    address: submission://smtp.gmail.com:587
    # gmail email address (username)
    username: email@gmail.com
    # use a google app password if using gmail
    password: somepassword
    # email address to show as sender
    sender: no-reply@example.com
    tls:
      server_name: smtp.gmail.com
      minimum_version: TLS1.2
      skip_verify: false
access_control:
  default_policy: "deny"
  rules:
    # basic rule for one factor (username/password) login for users in the admin group
    - domain:
        - "*.${INGRESS_URL}"
        - ${INGRESS_URL}
      policy: one_factor
      subject: "group:lldap_strict_readonly"
    # basic rule for one factor (username/password) login for users in the admin group
    - domain:
        - "*.${INGRESS_URL}"
        - ${INGRESS_URL}
      policy: one_factor
      subject: "group:admin"
log:
  level: "trace"
identity_providers:
  oidc:
    cors:
      endpoints: ["authorization", "token", "revocation", "introspection"]
      allowed_origins_from_client_redirect_uris: true
    #hmac_secret: "${AUTHELIA_HMAC_SECRET}"
    #jwks:
    #  - algorithm: "RS256"
    #    use: "sig"
    #    key: |
    #      {{ secret "/opt/mg/private.pem" | mindent 10 "|" | msquote }}
    clients:
      - client_id: ${OUTLINE_OIDC_CLIENT_ID}
        client_name: "Outline"
        client_secret: "${OUTLINE_HASHED_OIDC_CLIENT_SECRET}"
        public: false
        authorization_policy: "one_factor"
        redirect_uris:
          - "https://outline.${DOMAIN_0}/auth/oidc.callback"
        scopes:
          - "openid"
          - "offline_access"
          - "profile"
          - "email"
        userinfo_signed_response_alg: "none"
        token_endpoint_auth_method: "client_secret_post"
